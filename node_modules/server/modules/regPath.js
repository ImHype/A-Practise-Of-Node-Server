module.exports = function  (url) {

  var str = new rtStr(url);
  str.trim().deleteQuery().replaceUrl();
  var re = new RegExp("^"+str.str+"$");
  re.params = str.paramNames;
  return re
}
function rtStr(name){
  this.str = name;
  this.paramNames=[];
}
rtStr.prototype.trim = function(){
  this.str = this.str.replace(/^\s*/gi,"").replace(/\s*$/gi,"")
  return this;
}
rtStr.prototype.deleteQuery = function(){
  this.str = this.str.replace(/(\?+.*$)/gi,"");
  return this;
}
rtStr.prototype.replaceUrl = function(){
  var paramNames = this.paramNames;
  this.str = this.str.replace(/\*+\//gi,"([0-9a-zA-Z\-_]*\/)")
  .replace(/(:(.*?(?=\/|$)))/g, function(){
    var len = arguments.length-3;
    var arg = null;

    for(var i=1;i<=len;i++){
        arg = arguments[i];

        if(typeof arg == 'string' && arg[0]!=':'){
            paramNames.push(arg);
        }
    }
    return "([0-9a-zA-Z\-_]*)";
  })
  .replace(/\//g, "\\\/"); 
  return this;
}