var fs = require("fs");
var url = require("url");
var path = require("path");
function url2path(urlpath){
	var path = url.parse(urlpath).pathname;
	return path;
}
module.exports = function (parent_path) {
	return function(req,res,next){
		var filepath = url2path(req.url);
		if(filepath.charAt(filepath.length-1)=='/'){
			var filepath = filepath+"index.html";
		}
		function callback(err,data){
			if(err){
				next();
			}else{
				res.write(data);
				res.end();
			}
		}
		fs.readFile(path.join(parent_path,filepath),callback);
	}
}